<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=content-type content="text/html"><meta name=viewport content="width=device-width,initial-scale=1"><title itemprop=name>#4 First Basic Combat (Chained by Eternity) | David Burgstaller</title>
<meta property="og:title" content="#4 First Basic Combat (Chained by Eternity) | David Burgstaller"><meta name=twitter:title content="#4 First Basic Combat (Chained by Eternity) | David Burgstaller"><meta itemprop=name content="#4 First Basic Combat (Chained by Eternity) | David Burgstaller"><meta name=application-name content="#4 First Basic Combat (Chained by Eternity) | David Burgstaller"><meta property="og:site_name" content="David Burgstaller"><meta name=description content="Minimal Hugo blog theme with light and dark mode support"><meta itemprop=description content="Minimal Hugo blog theme with light and dark mode support"><meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support"><meta name=twitter:description content="Minimal Hugo blog theme with light and dark mode support"><meta property="og:locale" content="en-gb"><meta name=language content="en-gb"><link rel=alternate hreflang=en-gb href=/devlog/devlog4_cbe/ title=English><meta name=generator content="Hugo 0.139.4"><meta property="og:url" content="/devlog/devlog4_cbe/"><meta property="og:site_name" content="David Burgstaller"><meta property="og:title" content="#4 First Basic Combat (Chained by Eternity)"><meta property="og:description" content="Hey There!
Thanks for taking the time to read my devlog.
I would really appreciate any kind of feedback - whether it’s about the project, my programming, or even my writing style - it really helps! And if you just feel like chatting about game development or want to connect, feel free to reach out. You can find my contact info here This devlog covers the development of my project, Chained by Eternity ."><meta property="og:locale" content="en_gb"><meta property="og:type" content="article"><meta property="article:section" content="devlog"><meta property="article:published_time" content="2024-04-11T18:47:54+02:00"><meta property="article:modified_time" content="2024-04-11T18:47:54+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="#4 First Basic Combat (Chained by Eternity)"><meta name=twitter:description content="Hey There!
Thanks for taking the time to read my devlog.
I would really appreciate any kind of feedback - whether it’s about the project, my programming, or even my writing style - it really helps! And if you just feel like chatting about game development or want to connect, feel free to reach out. You can find my contact info here This devlog covers the development of my project, Chained by Eternity ."><link rel=canonical href=/devlog/devlog4_cbe/><link href=/style.min.1ec48890857669bc7458e4105aeb8a945892a6749fab618442077cfddc31b353.css rel=stylesheet><link href=/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css rel=stylesheet><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icons/favicon-16x16.png><link rel=mask-icon href=/icons/safari-pinned-tab.svg><link rel="shortcut icon" href=/favicon.ico><link rel=manifest href=/site.webmanifest><meta name=msapplication-config content="/browserconfig.xml"><meta name=msapplication-TileColor content="#2d89ef"><meta name=theme-color content="#434648"><link rel=icon type=image/svg+xml href=/icons/favicon.svg><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin=anonymous crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})'></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-67BGNEWG64"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-67BGNEWG64")}</script></head><body data-theme=dark class=notransition><script src=/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script><div class=navbar role=navigation><nav class=menu aria-label="Main Navigation"><a href=/ class=logo><svg width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home"><title>Home</title><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
</a><input type=checkbox id=menu-trigger class=menu-trigger>
<label for=menu-trigger><span class=menu-icon><svg width="25" height="25" stroke="currentcolor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7H3.40726"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"/><path stroke-linecap="round" stroke-linejoin="round" d="M.5 12.5V1.5c0-.552285.447715-1 1-1h11C13.0523.5 13.5.947715 13.5 1.5v11C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C.947715 13.5.5 13.0523.5 12.5z"/></svg></span></label><div class=trigger><ul class=trigger-container><li><a class=menu-link href=/>Home</a></li><li><a class="menu-link active" href=/devlog/>Devlogs</a></li><li><a class=menu-link href=/about/>About</a></li><li><a class=menu-link href=/article/>Articles</a></li><li><a class=menu-link href=/project/>Projects</a></li><li class=menu-separator><span>|</span></li></ul><a id=mode href=#><svg class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg><svg class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1"><title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1=".5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1=".5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"/><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"/></g></svg></a></div></nav></div><div class="wrapper post"><main class=page-content aria-label=Content><article><header class=header><h1 class=header-title>#4 First Basic Combat (Chained by Eternity)</h1><div class=post-meta><time datetime=2024-04-11T18:47:54+02:00 itemprop=datePublished>11 Apr 2024</time></div></header><div class=page-content><blockquote><p><strong>Hey There!</strong><br>Thanks for taking the time to read my devlog.<br>I would really appreciate any kind of <strong>feedback</strong> - whether it’s about the project, my programming, or even my writing style - <strong>it really helps!</strong>
And if you just feel like chatting about game development or want to connect, feel free to reach out.
You can find my contact info <a href=https://david-burgstaller.de/about/ target=_blank rel="noreferrer nofollow">here</a></p><p>This devlog covers the development of my project, <a href=https://www.david-burgstaller.de/project/chainedbyeternity/ target=_blank rel="noreferrer nofollow">Chained by Eternity</a>
.</p></blockquote><p>Now that I have an attribute system in place, it&rsquo;s time to test it - and what better way to do that than by implementing basic combat?
I decided to dive into <code>GameplayAbilities</code> and implement my first combat ability to deal damage to a target.</p><h3 id=damage-gameplay-abilities>Damage Gameplay Abilities</h3><p>For my damage based <code>GameplayAbilities</code>, I created
a custom <code>UDamageGameplayAbility</code> class to handle all damage-related logic.</p><h5 id=damage-types>Damage Types</h5><p>First of all this class defines a public <code>DamageTypes</code> map like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>UPROPERTY(EditDefaultsOnly, BlueprintReadOnly, Category <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Damage&#34;</span>)
</span></span><span style=display:flex><span>	TMap<span style=color:#f92672>&lt;</span>FGameplayTag, FScalableFloat<span style=color:#f92672>&gt;</span> DamageTypes;
</span></span></code></pre></div><p>This allowes me to assign multiple damage types with corresponding damage values to this ability - either via Blueprint or in C++.<br>Each damage type is represented by a <code>FGameplayTag</code>. So far, I&rsquo;ve defined four basic types:</p><ul><li>Physical Damage</li><li>Fire Damage</li><li>Ice Damage</li><li>Arcane Damage</li></ul><p>I’m not yet sure whether I’ll keep all of these, but changing or expanding them later on shouldn’t be an issue at all.</p><h5 id=damage-calculation>Damage Calculation</h5><p>Secondly, I define a <code>UGameplayEffect</code> variable that tells the ability which <code>GameplayEffect</code> class to use for applying damage. The <code>GameplayEffect</code> itself handles how the <code>Ability System Component</code> applies damage to the specified target.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>UPROPERTY(EditDefaultsOnly, BlueprintReadOnly)
</span></span><span style=display:flex><span>TSubclassOf<span style=color:#f92672>&lt;</span>UGameplayEffect<span style=color:#f92672>&gt;</span> DamageEffectClass;
</span></span></code></pre></div><p>In addition, I implemented an <code>ApplyDamageToTarget(AActor* TargetCharacter)</code> function. This utility function can be called by any future <code>GameplayAbilitiy</code> that derives from this class to apply damage to a specified target.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> UDamageGameplayAbility<span style=color:#f92672>::</span>ApplyDamageToTarget(AActor<span style=color:#f92672>*</span> TargetCharacter)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> (TargetCharacter)
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> UAbilitySystemComponent<span style=color:#f92672>*</span> SourceAbilitySystemComponent <span style=color:#f92672>=</span> UAbilitySystemBlueprintLibrary<span style=color:#f92672>::</span>GetAbilitySystemComponent(GetAvatarActorFromActorInfo());
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> FGameplayEffectSpecHandle SpecHandle <span style=color:#f92672>=</span> SourceAbilitySystemComponent<span style=color:#f92672>-&gt;</span>MakeOutgoingSpec(DamageEffectClass, GetAbilityLevel(), SourceAbilitySystemComponent<span style=color:#f92672>-&gt;</span>MakeEffectContext());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> (TPair<span style=color:#f92672>&lt;</span>FGameplayTag, FScalableFloat<span style=color:#f92672>&gt;&amp;</span> DamageTypePair : DamageTypes)
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>float</span> ScaledDamage <span style=color:#f92672>=</span> DamageTypePair.Value.GetValueAtLevel(GetAbilityLevel());
</span></span><span style=display:flex><span>			UAbilitySystemBlueprintLibrary<span style=color:#f92672>::</span>AssignTagSetByCallerMagnitude(SpecHandle, DamageTypePair.Key, ScaledDamage);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		UAbilitySystemComponent<span style=color:#f92672>*</span> TargetAbilitySystemComponent <span style=color:#f92672>=</span> UAbilitySystemBlueprintLibrary<span style=color:#f92672>::</span>GetAbilitySystemComponent(TargetCharacter);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (TargetAbilitySystemComponent)
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			TargetAbilitySystemComponent<span style=color:#f92672>-&gt;</span>ApplyGameplayEffectSpecToTarget(<span style=color:#f92672>*</span>SpecHandle.Data.Get(), TargetAbilitySystemComponent);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Inside this function, I iterate through all damage types set on the ability and use <code>AssignTagSetByCallerMagnitude</code> to assign these values to the corrusponding tag. These values are then passed to the <code>GameplayEffectSpecHandle</code> which is applied to the target at the end of the function.</p><p>Inside my associated <code>GameplayEffect</code> class, I refer to these set-by-caller magnitudes. To do so, I set the <code>Modifier Type</code> to a <code>Custom Calculation Class</code>. This allows me to implement a custom <code>UGameplayEffectExecutionCalculation</code> class, where I perform all complex damage calculations.<br>Here&rsquo;s an excerpt from that class:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> UExecCalc_Damage<span style=color:#f92672>::</span>Execute_Implementation(<span style=color:#66d9ef>const</span> FGameplayEffectCustomExecutionParameters<span style=color:#f92672>&amp;</span> ExecutionParams, 
</span></span><span style=display:flex><span>	FGameplayEffectCustomExecutionOutput<span style=color:#f92672>&amp;</span> OutExecutionOutput) <span style=color:#66d9ef>const</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> UAbilitySystemComponent<span style=color:#f92672>*</span> SourceAbilitySystemComponent <span style=color:#f92672>=</span> ExecutionParams.GetSourceAbilitySystemComponent();
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> UAbilitySystemComponent<span style=color:#f92672>*</span> TargetAbilitySystemComponent <span style=color:#f92672>=</span> ExecutionParams.GetTargetAbilitySystemComponent();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> FGameplayEffectSpec <span style=color:#f92672>&amp;</span>Spec <span style=color:#f92672>=</span> ExecutionParams.GetOwningSpec();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> FGameplayTagContainer <span style=color:#f92672>*</span>SourceTags <span style=color:#f92672>=</span> Spec.CapturedSourceTags.GetAggregatedTags();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> FGameplayTagContainer <span style=color:#f92672>*</span>TargetTags <span style=color:#f92672>=</span> Spec.CapturedTargetTags.GetAggregatedTags();
</span></span><span style=display:flex><span>    FAggregatorEvaluateParameters EvaluationParameters;
</span></span><span style=display:flex><span>    EvaluationParameters.SourceTags <span style=color:#f92672>=</span> SourceTags;
</span></span><span style=display:flex><span>    EvaluationParameters.TargetTags <span style=color:#f92672>=</span> TargetTags;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>float</span> Damage <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>for</span> (FGameplayTag DamageTypeTag : FGameGameplayTags<span style=color:#f92672>::</span>Get().DamageTypes)
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>float</span> <span style=color:#66d9ef>const</span> DamageTypeValue <span style=color:#f92672>=</span> Spec.GetSetByCallerMagnitude(DamageTypeTag);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Physical damage is reduced by armor
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>if</span> (DamageTypeTag.MatchesTagExact(FGameGameplayTags<span style=color:#f92672>::</span>Get().Damage_Physical))
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>float</span> Armor <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.f</span>;
</span></span><span style=display:flex><span>            ExecutionParams.AttemptCalculateCapturedAttributeMagnitude(DamageStatics().ArmorDef, EvaluationParameters, Armor);
</span></span><span style=display:flex><span>            Armor <span style=color:#f92672>=</span> FMath<span style=color:#f92672>::</span>Max<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>float</span><span style=color:#f92672>&gt;</span>(<span style=color:#ae81ff>0.f</span>, Armor);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>float</span> BlockedDamagePercentage <span style=color:#f92672>=</span> Armor <span style=color:#f92672>/</span> (Armor <span style=color:#f92672>+</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>*</span> DamageTypeValue));
</span></span><span style=display:flex><span>            Damage <span style=color:#f92672>+=</span> DamageTypeValue <span style=color:#f92672>-</span> (BlockedDamagePercentage <span style=color:#f92672>*</span> DamageTypeValue);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        [...]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> FGameplayModifierEvaluatedData <span style=color:#a6e22e>EvaluatedData</span>(UBasicAttributeSet<span style=color:#f92672>::</span>GetIncomingDMGAttribute(), EGameplayModOp<span style=color:#f92672>::</span>Override, Damage);
</span></span><span style=display:flex><span>    OutExecutionOutput.AddOutputModifier(EvaluatedData);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>These <code>UGameplayEffectExecutionCalculation</code> classes are extremly powerfull. Here I can incorporate multiple attributes from both the source and target <code>AbilitySystemComponent</code> into my calculations. I could even change those attributes on the fly or perform any other crazy stuff a programmer could dream of. The only disadvanted is that these classes are not predicted which my be important to know if you are working on a multiplayer game.</p><p>In my current setup, things are still fairly straightforward: I reference the tag-assigned magnitudes from earlier, account for the targets resistances like armor, and reduce the final damage accordingly.</p><p>The example above demonstrates how physical damage is reduced based on the target&rsquo;s armor using a mathematical formulat. Over time, I plan to expand this system to handle more combat mechanics like criticle hits,
evasion, block chances, etc.</p><h3 id=melee-attack-gameplay-ability>Melee Attack Gameplay Ability</h3><p>Okay, that was a lot of theory - I really want to finally hit something.</p><p>To get started, I needed to prepare a few animations. I&rsquo;m keeping things simple for now, but later I plan to refine the melee combat system with features like <strong>combo attacks</strong> that depend on the equipped weapon, and an <strong>enable/disable capsule hitbox system</strong> similar to what you’d see in the Souls series.</p><p>But for now, I just want to keep it simple: play an attack animation, spawn a hitbox sphere, and apply damage to everything that can be hit inside it.</p><p>First, I created a attack <code>Animation Montage</code> and added a <code>AnimNotify</code> that is triggering a <code>GameplayEvent</code> using a specified <code>GameplayTag</code>. I Then added a sword mesh and created a <code>CombatSocket</code> socket on it to define the location where the hitbox sphere will be spawned during an attack.<br>On my character, I added two sockets - <code>WeaponLeft</code> and <code>WeaponRight</code> - where I can attach my weapon class later on. Next, I created a weapon <code>AActor</code> class, assigned the sword mesh to it and attached this actor to my character.</p><p>To keep the design cleaner and more scalable, I also created a <code>**ICombatInterface**</code>. My reasoning was that, later on, I might want to hit things beyond just enemy characters like breakable walls or other interactive static <code>AActors</code>. By having those actors implement the <code>ICombatInterface</code>, I can make them &ldquo;combat-aware.&rdquo; The interface defines what needs to be implemented for an <code>AActor</code> to interact with the combat system.</p><p>There was one last thing missing from my Melee Attack <code>GameplayAbility</code>: I only want to attack if the player actually clicks on something that can be attacked. I solved this by creating a custom <code>AbilityTask</code> that performs a mouse-to-world raycast and checks if a valid, hittable <code>AActor</code> was hit.</p><p>With everything prepared, the final structure of my Melee Attack <code>GameplayAbility</code> is actually quite simple:</p><ul><li>When the ability is activated, I run the custom <code>AbilityTask</code> to detect whether a valid target (an actor that implements <code>ICombatInterface</code>) was hit.</li><li>If the result is valid, I use <code>AbilityTask_PlayMontageAndWait</code> to play my attack <code>Animation Montage</code>.</li><li>Then, I call <code>AbilityTask_WaitForGameplayTag</code> to listen for the <code>AnimNotify</code> tag embedded in the animation.</li><li>When the notify is received, I spawn an invisible hitbox sphere at the weapon’s socket location and check for any overlapping actors that implement <code>ICombatInterface</code></li><li>For each valid target, I call <code>ApplyDamageToTarget()</code> as described earlier to apply the damage.</li></ul><p>All together is looks like this:</p><video width=100% controls style="display:block;width:80%;margin:0 auto">
<source src=/videos/devlog4_CBE/FirstCombat.mp4 type=video/mp4></video><p>It looks pretty clunky but it works. Enemies are hit, Damage is dealt and health is lost. So we can move on for now.</p></div></article></main></div><footer class=footer><span class=footer_item></span>&nbsp;<div class=footer_social-icons><a href=david.burgstaller@yahoo.de target=_blank rel="noopener noreferrer me" title=Email><svg viewBox="0 0 24 21" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</a><a href=https://github.com/Roqum target=_blank rel="noopener noreferrer me" title=Github><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</a><a href=https://www.linkedin.com/in/david-burgstaller/ target=_blank rel="noopener noreferrer me" title=Linkedin><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</a><a href=https://x.com/DavidBGameDev target=_blank rel="noopener noreferrer me" title=Twitter><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></div><small class=footer_copyright>© 2025 David Burgstaller.
Powered by <a href=https://github.com/hugo-sid/hugo-blog-awesome target=_blank rel=noopener>Hugo blog awesome</a>.</small></footer><a href=# title="Go to top" id=totop><svg width="48" height="48" fill="currentcolor" stroke="currentcolor" viewBox="0 96 960 960"><path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197z"/></svg>
</a><script src=/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30+lSNuSkl4QXuNyy8="></script></body></html>